{
  "_comment": "MinerU Optimal Unified Configuration for KANNA Thesis (2025 Models)",
  "_purpose": "Production-ready config with latest doclayout_yolo(2501), unimernet(2503), RapidTable",
  "_version": "2025-10-08 (post-comprehensive-audit)",
  "_documentation": "See ~/LAB/projects/KANNA/docs/MINERU-CONFIGURATION-ANALYSIS.md",
  "_changes": [
    "Enabled doclayout_yolo(2501) - 10x faster than layoutlmv3",
    "Updated to unimernet(2503) - fixes multi-line formula line breaks",
    "Integrated RapidTable - 10x faster table extraction",
    "Standardized LaTeX delimiters for Overleaf compatibility",
    "Consolidated model storage to external HDD",
    "Secured API key via environment variable"
  ],

  "device-mode": "cuda",
  "config_version": "1.3.0",

  "layout-config": {
    "_comment": "DocLayout-YOLO(2501): Latest 2025 model, 10x faster, 50% speed boost on 16GB+ GPU",
    "model": "doclayout_yolo",
    "imgsz": 1024,
    "conf": 0.2
  },

  "formula-config": {
    "_comment": "Unimernet(2503): Latest 2025 model, fixed multi-line formula line breaks",
    "enable": true,
    "mfd_model": "yolo_v8_mfd",
    "mfr_model": "unimernet_small"
  },

  "table-config": {
    "_comment": "RapidTable: 10x faster, lower GPU memory usage, integrated in 2025",
    "model": "rapid_table",
    "enable": true,
    "max_time": 400
  },

  "latex-delimiter-config": {
    "_comment": "Overleaf thesis compatibility: \\[ \\] for display, $ $ for inline (standard LaTeX)",
    "display": {
      "left": "\\[",
      "right": "\\]"
    },
    "inline": {
      "left": "$",
      "right": "$"
    }
  },

  "llm-aided-config": {
    "_comment": "Claude Sonnet 4.5 for formula recognition (95-98% accuracy)",
    "_security": "API key stored in ~/.config/codex/secrets.env (ANTHROPIC_API_KEY)",
    "_cost": "$0.020/paper (~$2.91 for 143 papers)",
    "_model": "claude-sonnet-4-5-20250929 (latest, Sep 2025 release)",
    "enable": false,
    "_enable_note": "Enable after testing (Phase 2)",
    "formula_aided": {
      "model": "claude-sonnet-4-5-20250929",
      "api_key": "${ANTHROPIC_API_KEY}",
      "base_url": "https://api.anthropic.com",
      "provider": "anthropic",
      "anthropic_version": "2023-06-01",
      "temperature": 0.1,
      "max_tokens": 2048,
      "use_for": ["formula", "table"],
      "fallback_to_ocr": true,
      "only_if_confidence_below": 0.80,
      "_selective_invocation": "Only call LLM for low-confidence OCR (<80%), reduces cost by 70%"
    }
  },

  "models-dir": "/home/miko/.mineru/models",
  "vlm-model-dir": "/run/media/miko/AYA/crush-models/hf-home/models--opendatalab--MinerU2.5-2509-1.2B",

  "processing-options": {
    "_comment": "Pipeline backend (GPU-accelerated YOLO+Unimernet)",
    "backend": "pipeline",
    "_backend_note": "Standard pipeline: doclayout_yolo + unimernet_small + rapid_table (all GPU-accelerated)",
    "lang": "auto",
    "_lang_note": "Auto-detect French/English (supports 84 languages)",
    "vram_limit": 12,
    "formula_enable": true,
    "table_enable": true
  },

  "output-formats": {
    "_comment": "Multi-format output for thesis workflow",
    "markdown": {
      "enable": true,
      "format": "obsidian-optimized",
      "include_metadata": true
    },
    "json": {
      "enable": true,
      "format": "middle_json",
      "_purpose": "Structured data for RAG/secondary development"
    },
    "visualization": {
      "layout_pdf": true,
      "spans_pdf": true,
      "_purpose": "Quality assurance and debugging"
    }
  },

  "quality-thresholds": {
    "_comment": "Confidence thresholds for automated quality flagging",
    "min_ocr_confidence": 0.85,
    "min_formula_confidence": 0.80,
    "min_table_confidence": 0.75
  },

  "thesis-specific": {
    "_comment": "KANNA project metadata and requirements",
    "chapters": {
      "4": "pharmacology-qsar",
      "5": "clinical-meta-analysis",
      "_priority": "Chemistry formulas (LaTeX), pharmacokinetics tables (HTML)"
    },
    "expected_papers": 500,
    "languages": ["fr", "en"],
    "sensitive_content": {
      "ethnobotanical_flagging": true,
      "_fpic_compliance": "Flag indigenous knowledge for manual review"
    }
  },

  "performance-expectations": {
    "_comment": "Expected performance with 2025 models (vs 2024 baseline)",
    "extraction_speed": "3 sec/paper (10x faster with doclayout_yolo)",
    "formula_accuracy": "85-90% (up from 60-70%)",
    "table_accuracy": ">85% (up from 60%)",
    "quality_score": "4.8/5 (up from 4.44/5)",
    "gpu_speedup": "50% faster on 16GB+ VRAM",
    "vllm_speedup": "20-30x if enabled (requires vllm installation)"
  },

  "advanced-options": {
    "_comment": "Optional performance tuning (currently disabled)",
    "_vlm_backend_example": {
      "backend": "vlm-vllm-engine",
      "vram_limit": 12,
      "_note": "Requires: pip install vllm"
    },
    "_multi_gpu_example": {
      "device": "cuda:0,cuda:1",
      "_note": "Batch processing across multiple GPUs"
    }
  },

  "troubleshooting": {
    "_comment": "Common issues and solutions",
    "_formula_not_extracted": "Check if PDF has text layer (pdftotext test.pdf -)",
    "_table_structure_issues": "Consider struct_eqtable model for complex tables",
    "_out_of_vram": "Reduce vram_limit or switch to CPU mode",
    "_api_key_error": "Ensure ANTHROPIC_API_KEY set in ~/.config/codex/secrets.env"
  }
}
